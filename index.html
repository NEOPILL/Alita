<script>
(function () {
  const canvas = document.getElementById('code-rain');
  const ctx = canvas.getContext('2d');

  let w = window.innerWidth;
  let h = window.innerHeight;
  const dpr = window.devicePixelRatio || 1;
  canvas.width = w * dpr;
  canvas.height = h * dpr;
  ctx.scale(dpr, dpr);

  // Neon glyphs
  const glyphs = "ALITA$01NE".split("");
  const fontSize = 22;
  let columns = Math.floor(w / fontSize);

  const drops = Array(columns).fill(0).map(() => Math.random() * -100);

  function resize() {
    w = window.innerWidth;
    h = window.innerHeight;
    canvas.width = w * dpr;
    canvas.height = h * dpr;
    ctx.setTransform(dpr, 0, 0, dpr, 0, 0);
    columns = Math.floor(w / fontSize);
    drops.length = columns;
    for (let i = 0; i < columns; i++) drops[i] = Math.random() * -100;
  }

  window.addEventListener('resize', resize);

  function draw() {
    // Dark trail for smooth matrix fade
    ctx.fillStyle = "rgba(0,0,0,0.12)";
    ctx.fillRect(0, 0, w, h);

    ctx.font = fontSize + "px Zerowax, monospace";
    ctx.textAlign = "center";
    ctx.shadowColor = "#ff009d";
    ctx.shadowBlur = 18;

    for (let i = 0; i < columns; i++) {
      const char = glyphs[Math.floor(Math.random() * glyphs.length)];
      const x = i * fontSize + fontSize / 2;
      const y = drops[i] * fontSize;

      ctx.fillStyle = "#ff35cf"; // Neon pink
      ctx.fillText(char, x, y);

      // Slow, smooth scroll
      drops[i] += 0.28;

      // Reset stream after passing screen
      if (y > h + fontSize * 2) {
        drops[i] = Math.random() * -60;
      }
    }

    requestAnimationFrame(draw);
  }

  draw();
})();
</script>
